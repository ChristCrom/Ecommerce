{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\chris\\\\OneDrive\\\\Coding\\\\Capstone\\\\Ecommerce\\\\03-frontend\\\\angular-ecommerce\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { from, lastValueFrom } from 'rxjs';\nimport { OKTA_AUTH } from '@okta/okta-angular';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@okta/okta-auth-js\";\nexport let AuthInterceptorService = /*#__PURE__*/(() => {\n  class AuthInterceptorService {\n    constructor(oktaAuth) {\n      this.oktaAuth = oktaAuth;\n    }\n\n    intercept(request, next) {\n      return from(this.handleAccess(request, next));\n    }\n\n    handleAccess(request, next) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        const theEndpoint = environment.HCLTechStoreUrl + '/orders';\n        const securedEndpoints = [theEndpoint];\n\n        if (securedEndpoints.some(url => request.urlWithParams.includes(url))) {\n          const accessToken = yield _this.oktaAuth.getAccessToken();\n          console.log(accessToken);\n          request = request.clone({\n            setHeaders: {\n              Authorization: \"Bearer \" + accessToken\n            }\n          });\n        } // return next.handle(request).toPromise();\n\n\n        const vari = lastValueFrom(next.handle(request));\n        return vari;\n      })();\n    }\n\n  }\n\n  AuthInterceptorService.ɵfac = function AuthInterceptorService_Factory(t) {\n    return new (t || AuthInterceptorService)(i0.ɵɵinject(OKTA_AUTH));\n  };\n\n  AuthInterceptorService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AuthInterceptorService,\n    factory: AuthInterceptorService.ɵfac,\n    providedIn: 'root'\n  });\n  return AuthInterceptorService;\n})();","map":null,"metadata":{},"sourceType":"module"}